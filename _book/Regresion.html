<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Fake_Instagram - 6&nbsp; Modelos de Regresión</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Series.html" rel="next">
<link href="./FCA.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Regresion.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Modelos de Regresión</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Fake_Instagram</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Detección de cuentas “Fake” de Instagram</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Análisis_Exploratorio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Análisis exploratorio de los datos</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Visualizacion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Visualización de Datos</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Reglas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Reglas de Asociación</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./FCA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">FCA - Formal Concept Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Regresion.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Modelos de Regresión</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Series temporales</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Otras_técnicas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Otras técnicas</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#importación-de-las-librerías-y-dataset" id="toc-importación-de-las-librerías-y-dataset" class="nav-link active" data-scroll-target="#importación-de-las-librerías-y-dataset"><span class="header-section-number">6.1</span> Importación de las librerías y Dataset</a></li>
  <li><a href="#modelado-de-regresión" id="toc-modelado-de-regresión" class="nav-link" data-scroll-target="#modelado-de-regresión"><span class="header-section-number">6.2</span> Modelado de Regresión</a>
  <ul class="collapse">
  <li><a href="#división-de-datos" id="toc-división-de-datos" class="nav-link" data-scroll-target="#división-de-datos"><span class="header-section-number">6.2.1</span> División de datos</a></li>
  <li><a href="#ajuste-del-modelo-de-regresión-y-evaluación" id="toc-ajuste-del-modelo-de-regresión-y-evaluación" class="nav-link" data-scroll-target="#ajuste-del-modelo-de-regresión-y-evaluación"><span class="header-section-number">6.2.2</span> Ajuste del modelo de regresión y evaluación</a></li>
  <li><a href="#validación-del-modelo" id="toc-validación-del-modelo" class="nav-link" data-scroll-target="#validación-del-modelo"><span class="header-section-number">6.2.3</span> Validación del modelo</a></li>
  <li><a href="#mejora-del-modelo" id="toc-mejora-del-modelo" class="nav-link" data-scroll-target="#mejora-del-modelo"><span class="header-section-number">6.2.4</span> Mejora del modelo</a></li>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"><span class="header-section-number">6.2.5</span> </a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Modelos de Regresión</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>El objetivo principal de realizar un modelo de regresión es predecir el valor de la variable dependiente (en este caso si la cuenta es fake o no) basado en los valores de las variables independientes y comprender la fuerza y la forma de las relaciones entre ellas.</p>
<section id="importación-de-las-librerías-y-dataset" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="importación-de-las-librerías-y-dataset"><span class="header-section-number">6.1</span> Importación de las librerías y Dataset</h2>
<p>Primero, antes de comenzar con la realización de los modelos de regresión, importaremos todas las librerías necesarias para aplicar los diferentes datos, además de importar el Dataset train.csv.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'lubridate' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.0     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)  </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'magrittr'

The following object is masked from 'package:purrr':

    set_names

The following object is masked from 'package:tidyr':

    extract</code></pre>
</div>
</div>
<p>Como ya tenemos todo bien importado, comenzamos.</p>
</section>
<section id="modelado-de-regresión" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="modelado-de-regresión"><span class="header-section-number">6.2</span> Modelado de Regresión</h2>
<section id="división-de-datos" class="level3" data-number="6.2.1">
<h3 data-number="6.2.1" class="anchored" data-anchor-id="división-de-datos"><span class="header-section-number">6.2.1</span> División de datos</h3>
<p>Para trabajar correctamente con los datos, vamos a dividirlos en dos grupos, train y test.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"train.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 576 Columns: 12
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
dbl (12): profile pic, nums/length username, fullname words, nums/length ful...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"test.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 120 Columns: 12
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
dbl (12): profile pic, nums/length username, fullname words, nums/length ful...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<p>Con el dataset train es con el que realizaremos nuestro modelo, mientras que con el dataset test es con el que realizaremos las pruebas y predicciones.</p>
</section>
<section id="ajuste-del-modelo-de-regresión-y-evaluación" class="level3" data-number="6.2.2">
<h3 data-number="6.2.2" class="anchored" data-anchor-id="ajuste-del-modelo-de-regresión-y-evaluación"><span class="header-section-number">6.2.2</span> Ajuste del modelo de regresión y evaluación</h3>
<p>Una vez dividido los datos, procederemos a ajustar un modelo de regresión con los datos de train. Al investigar las cuentas fake de Instagram, la variable dependiente de nuestro modelo será el atributo fake. Primero relacionaremos esa variable con todas las demás, para ver cuáles son significativas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(train)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>modelo1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(fake <span class="sc">~</span> ., <span class="at">data =</span> train)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = fake ~ ., data = train)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.73096 -0.23729 -0.06653  0.24048  1.01052 

Coefficients:
                         Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)             7.931e-01  3.798e-02  20.880  &lt; 2e-16 ***
`profile pic`          -4.380e-01  3.345e-02 -13.094  &lt; 2e-16 ***
`nums/length username`  8.062e-01  7.522e-02  10.718  &lt; 2e-16 ***
`fullname words`       -3.354e-02  1.333e-02  -2.516 0.012142 *  
`nums/length fullname` -2.775e-02  1.212e-01  -0.229 0.818988    
`name==username`        2.241e-01  7.641e-02   2.933 0.003498 ** 
`description length`   -1.510e-03  4.342e-04  -3.478 0.000544 ***
`external URL`         -1.542e-01  4.800e-02  -3.213 0.001390 ** 
private                -9.459e-03  2.843e-02  -0.333 0.739459    
`#posts`               -9.094e-05  3.570e-05  -2.547 0.011120 *  
`#followers`           -9.960e-09  1.539e-08  -0.647 0.517743    
`#follows`             -1.850e-05  1.499e-05  -1.235 0.217530    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3166 on 564 degrees of freedom
Multiple R-squared:  0.6074,    Adjusted R-squared:  0.5998 
F-statistic: 79.33 on 11 and 564 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>De este modelo podemos sacar lo siguiente:</p>
<ul>
<li><p>Al ser el p-value bastante bajo, podemos decir que tenemos modelo.</p></li>
<li><p>El error estándar residual es relativamente bajo, por lo que nos puede dar un indicio de que las predicciones pueden ser buenas.</p></li>
<li><p>En este caso al ser un contexto social y tener una variablilidad alta, es un buen valor por lo que el error se ajusta parcialmente a los datos.</p></li>
<li><p>Al ser el R2 ajustado cercano al estadístico anterior, sugiere que el modelo no está sobreajustado y que la mayoría de las variables incluidas son relevamtes.</p></li>
</ul>
<p>Sin embargo, tenemos bastantes variables no significativas, lo que significa que si se eliminan, el modelo apenas no cambia. Para comprobarlo, vamos a hacer un segundo modelo, sin las variables no significativas, solo quedándonos con las muy significativas y las significativas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>modelo2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(fake <span class="sc">~</span> <span class="st">`</span><span class="at">profile pic</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">nums/length username</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">description length</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">name==username</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">external URL</span><span class="st">`</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = fake ~ `profile pic` + `nums/length username` + 
    `description length` + `name==username` + `external URL`)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.71113 -0.24453 -0.07143  0.24282  0.98317 

Coefficients:
                         Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)             0.7354681  0.0316443  23.242  &lt; 2e-16 ***
`profile pic`          -0.4596554  0.0328023 -14.013  &lt; 2e-16 ***
`nums/length username`  0.8445023  0.0687052  12.292  &lt; 2e-16 ***
`description length`   -0.0017381  0.0004285  -4.056 5.68e-05 ***
`name==username`        0.2314540  0.0733411   3.156 0.001685 ** 
`external URL`         -0.1731966  0.0477099  -3.630 0.000309 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3196 on 570 degrees of freedom
Multiple R-squared:  0.5956,    Adjusted R-squared:  0.592 
F-statistic: 167.9 on 5 and 570 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Como podemos observar, efectivamente este modelo es prácticamente igual que el anterior, aún elimando variables independientes.</p>
</section>
<section id="validación-del-modelo" class="level3" data-number="6.2.3">
<h3 data-number="6.2.3" class="anchored" data-anchor-id="validación-del-modelo"><span class="header-section-number">6.2.3</span> Validación del modelo</h3>
<p>Ahora lo que haremos será evaluar el segundo modelo obtenido.</p>
<section id="visualización" class="level4" data-number="6.2.3.1">
<h4 data-number="6.2.3.1" class="anchored" data-anchor-id="visualización"><span class="header-section-number">6.2.3.1</span> Visualización</h4>
<p>Para la validación del modelo, primero vamos a dibujarlo y analizarlo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(modelo2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Regresion_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Regresion_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Regresion_files/figure-html/unnamed-chunk-5-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Regresion_files/figure-html/unnamed-chunk-5-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Tras ver la primera gráfica, podemos saber que los residuos no se esparcen aleatoriamente, si no que siguen un patrón que es fácilmente visible. Esto nos indica que el modelo de regresión lineal actual no es adecuado para los datos. Por lo tanto es importante reconsiderar la especificación del modelo, adoptando métodos de modelado alternativos para capturar mejor la relación entre los datos.</p>
<p>La última gráfica nos enseña los puntos que tienen más influencia en el modelo. Como podemos ver, algunos puntos de datos están influyendo desproporcionadamente en el modelo de regresión. Una buena solución es eliminar esos datos de nuestro dataset , volver a realizar el modelo y repetir este proceso. Además, se puede observar que los residuos están agrupados formando un patrón, posiblemente causado por la violación de supuestos del modelo.</p>
</section>
<section id="evaluación-en-el-conjunto-de-prueba" class="level4" data-number="6.2.3.2">
<h4 data-number="6.2.3.2" class="anchored" data-anchor-id="evaluación-en-el-conjunto-de-prueba"><span class="header-section-number">6.2.3.2</span> Evaluación en el conjunto de prueba</h4>
<p>Ahora, usando el modelo entrenado, vamos a predecir los valores en el conjunto de prueba, a ver que estadísticos obtenemos y así podemos comprobar si nuestro modelo tiene un buen rendimiento con respecto al conjunto de prueba.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelo2, <span class="at">newdata =</span> test)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(predictions <span class="sc">&lt;</span> <span class="fl">0.5</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>mse <span class="ot">&lt;-</span> <span class="fu">mean</span>((test<span class="sc">$</span>fake <span class="sc">-</span> predictions)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>mse </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1083333</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>mae <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(test<span class="sc">$</span>fake <span class="sc">-</span> predictions))</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>mae</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1083333</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>r_squared <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">sum</span>((test<span class="sc">$</span>fake <span class="sc">-</span> predictions)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">sum</span>((test<span class="sc">$</span>fake <span class="sc">-</span> <span class="fu">mean</span>(test<span class="sc">$</span>fake))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>r_squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5666667</code></pre>
</div>
</div>
<p><strong>MSE (Error cuadrático medio)</strong></p>
<ul>
<li><p>El mse mide el promedio de los cuadrados de los errores o desviaciones, es decir, la diferencia entre los valores observados y los predichos.</p></li>
<li><p>En este caso hemos obtenido un mse de 0.10. Sin embargo, este valor es demasiado alto, ya que el atributo fake toma valores entre 0 y 1, por lo que nos está indicando que no se ajusta relativamente bien al modelo</p></li>
</ul>
<p><strong>MAE (Error absoluto medio)</strong></p>
<ul>
<li><p>EL mae mide el promedio de los errores absolutos entre los valores observados y los predichos. Es más robusto a outliers en comparación con el mse.</p></li>
<li><p>En nuestro caso hemos obtenido un mae de 0.10, el cuál es el mismo que el mse, por lo que ocurre lo mismo</p></li>
</ul>
<p><strong>R2</strong></p>
<ul>
<li><p>Indica la proporción de la varianza en la variable dependiente que es predecible a partir de las variables independientes. Un R2 cercano a 1 indica un buen ajuste del modelo.</p></li>
<li><p>En este caso el R2 es bastante escaso, un 0.56. Lo que nos vuelve a indicar un mal ajuste a los datos del modelo.</p></li>
</ul>
</section>
</section>
<section id="mejora-del-modelo" class="level3" data-number="6.2.4">
<h3 data-number="6.2.4" class="anchored" data-anchor-id="mejora-del-modelo"><span class="header-section-number">6.2.4</span> Mejora del modelo</h3>
<p>Al obtener unos resultados bastantes mediocres en la validación del modelo, vamos a mejorarlo añadiendo variables polinómicas. Iremos probando algunas hasta encontrar la combinación óptima que mejore nuestro modelo al completo.</p>
<section id="ingeniería-de-características" class="level4" data-number="6.2.4.1">
<h4 data-number="6.2.4.1" class="anchored" data-anchor-id="ingeniería-de-características"><span class="header-section-number">6.2.4.1</span> Ingeniería de Características</h4>
<p>Para intentar mejorar aun más el modelo, con los datos y variables que disponemos, vamos a intentar sacar nuevas variables operando con las existentes. Por ejemplo, vamos a ver si añadiendo una característica que sea followers/follows podemos mejorar el modelo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>train<span class="sc">$</span>new_feature <span class="ot">&lt;-</span> train<span class="sc">$</span><span class="st">`</span><span class="at">#follows</span><span class="st">`</span><span class="sc">/</span> train<span class="sc">$</span><span class="st">`</span><span class="at">#followers</span><span class="st">`</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>train<span class="sc">$</span>new_feature2 <span class="ot">&lt;-</span> train<span class="sc">$</span><span class="st">`</span><span class="at">description length</span><span class="st">`</span><span class="sc">/</span> train<span class="sc">$</span><span class="st">`</span><span class="at">#followers</span><span class="st">`</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Eliminamos los infinitos</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> train <span class="sc">%&gt;%</span> <span class="fu">filter</span>(new_feature <span class="sc">!=</span> <span class="cn">Inf</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(new_feature2 <span class="sc">!=</span> <span class="cn">Inf</span>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from train (pos = 3):

    #followers, #follows, #posts, description length, external URL,
    fake, fullname words, name==username, nums/length fullname,
    nums/length username, private, profile pic</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>modelo2.update <span class="ot">&lt;-</span> <span class="fu">update</span>(modelo2, . <span class="sc">~</span> . <span class="sc">+</span> new_feature <span class="sc">+</span> new_feature2)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo2.update)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = fake ~ `profile pic` + `nums/length username` + 
    `description length` + `name==username` + `external URL` + 
    new_feature + new_feature2)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.67071 -0.23077 -0.06686  0.18271  1.01721 

Coefficients:
                        Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)             0.681296   0.033468  20.356  &lt; 2e-16 ***
`profile pic`          -0.434518   0.033422 -13.001  &lt; 2e-16 ***
`nums/length username`  0.854855   0.068426  12.493  &lt; 2e-16 ***
`description length`   -0.001788   0.000428  -4.177 3.44e-05 ***
`name==username`        0.257906   0.073403   3.514 0.000479 ***
`external URL`         -0.146429   0.046858  -3.125 0.001872 ** 
new_feature             0.007180   0.001692   4.243 2.59e-05 ***
new_feature2            0.006263   0.002161   2.899 0.003897 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3119 on 550 degrees of freedom
Multiple R-squared:  0.616, Adjusted R-squared:  0.6111 
F-statistic:   126 on 7 and 550 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section id="selección-de-variables" class="level4" data-number="6.2.4.2">
<h4 data-number="6.2.4.2" class="anchored" data-anchor-id="selección-de-variables"><span class="header-section-number">6.2.4.2</span> Selección de variables</h4>
<p>Tal y como hemos estudiando anteriormente, una variable clave para detectar si una cuenta es falsa o no es el numero de palabras que tiene el nombre, así que vamos a añadirle a nuestro modelo esa variable polinómica a ver que ocurre.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>modelo2.update <span class="ot">&lt;-</span> <span class="fu">update</span>(modelo2.update, . <span class="sc">~</span> . <span class="sc">+</span> <span class="fu">I</span>(<span class="st">`</span><span class="at">fullname words</span><span class="st">`</span><span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo2.update)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = fake ~ `profile pic` + `nums/length username` + 
    `description length` + `name==username` + `external URL` + 
    new_feature + new_feature2 + I(`fullname words`^2))

Residuals:
     Min       1Q   Median       3Q      Max 
-0.67437 -0.23185 -0.06312  0.18688  1.02784 

Coefficients:
                         Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)             0.6844401  0.0337092  20.304  &lt; 2e-16 ***
`profile pic`          -0.4333272  0.0334664 -12.948  &lt; 2e-16 ***
`nums/length username`  0.8517165  0.0685604  12.423  &lt; 2e-16 ***
`description length`   -0.0017457  0.0004313  -4.047 5.92e-05 ***
`name==username`        0.2559699  0.0734672   3.484 0.000533 ***
`external URL`         -0.1456509  0.0468834  -3.107 0.001990 ** 
new_feature             0.0071451  0.0016933   4.220 2.86e-05 ***
new_feature2            0.0061890  0.0021632   2.861 0.004383 ** 
I(`fullname words`^2)  -0.0013234  0.0016543  -0.800 0.424078    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.312 on 549 degrees of freedom
Multiple R-squared:  0.6164,    Adjusted R-squared:  0.6109 
F-statistic: 110.3 on 8 and 549 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Como vemos no cambia en nada, por lo que hay que seguir probando hasta dar con una mejora correcta.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>modelo2.update <span class="ot">&lt;-</span> <span class="fu">update</span>(modelo2.update, . <span class="sc">~</span> . <span class="sc">-</span> <span class="fu">I</span>(<span class="st">`</span><span class="at">fullname words</span><span class="st">`</span><span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(<span class="st">`</span><span class="at">description length</span><span class="st">`</span><span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(<span class="st">`</span><span class="at">nums/length username</span><span class="st">`</span><span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="st">`</span><span class="at">nums/length username</span><span class="st">`</span> <span class="sc">*</span> <span class="st">`</span><span class="at">#posts</span><span class="st">`</span> <span class="sc">+</span> <span class="fu">I</span>(<span class="st">`</span><span class="at">nums/length username</span><span class="st">`</span><span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> <span class="st">`</span><span class="at">#posts</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">#posts</span><span class="st">`</span> <span class="sc">+</span> <span class="fu">I</span>(new_feature<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo2.update)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = fake ~ `profile pic` + `nums/length username` + 
    `description length` + `name==username` + `external URL` + 
    new_feature + new_feature2 + I(`description length`^2) + 
    I(`nums/length username`^2) + I(new_feature^2) + `nums/length username`:`#posts` + 
    I(`nums/length username`^2):`#posts`)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.70635 -0.19447 -0.05844  0.14044  0.87632 

Coefficients:
                                       Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                           6.190e-01  3.402e-02  18.195  &lt; 2e-16 ***
`profile pic`                        -3.715e-01  3.233e-02 -11.491  &lt; 2e-16 ***
`nums/length username`                1.499e+00  1.605e-01   9.338  &lt; 2e-16 ***
`description length`                 -6.842e-03  1.084e-03  -6.312 5.71e-10 ***
`name==username`                      2.251e-01  6.842e-02   3.290  0.00107 ** 
`external URL`                       -1.277e-01  4.378e-02  -2.916  0.00369 ** 
new_feature                           2.315e-02  3.925e-03   5.899 6.42e-09 ***
new_feature2                          3.243e-03  2.036e-03   1.593  0.11184    
I(`description length`^2)             4.445e-05  8.327e-06   5.339 1.38e-07 ***
I(`nums/length username`^2)          -1.137e+00  2.353e-01  -4.832 1.76e-06 ***
I(new_feature^2)                     -2.290e-04  4.858e-05  -4.714 3.09e-06 ***
`nums/length username`:`#posts`      -3.992e-03  1.388e-03  -2.876  0.00418 ** 
I(`nums/length username`^2):`#posts`  6.912e-03  3.680e-03   1.878  0.06088 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2898 on 545 degrees of freedom
Multiple R-squared:  0.6715,    Adjusted R-squared:  0.6643 
F-statistic: 92.85 on 12 and 545 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Tras unos intentos, he llegado a la conclusión que este modelo no se puede mejorar más. Una de las causas es porque, de las variables significativas, si su valor es o 0 o 1, no tiene sentido elevarlo a algún numero, ya que se va a mantener igual. Otra de las causas es que del resto de variables numericas con mayor rango de números, si esas variables no son significativas en nuestro modelo, difícilmente lo serán en nuestro modelo polinómico.</p>
<p>Por tanto, hemos conseguido mejorar nuestro modelo a un error estándar de residuos de 0.29 y a un R2 de 0.6715, 0.08 más que el anterior.</p>
</section>
<section id="interpretación-y-visualización" class="level4" data-number="6.2.4.3">
<h4 data-number="6.2.4.3" class="anchored" data-anchor-id="interpretación-y-visualización"><span class="header-section-number">6.2.4.3</span> Interpretación y Visualización</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">summary</span>(modelo2.update))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                          Estimate   Std. Error    t value
(Intercept)                           6.189670e-01 3.401933e-02  18.194568
`profile pic`                        -3.715207e-01 3.233134e-02 -11.491037
`nums/length username`                1.499217e+00 1.605420e-01   9.338473
`description length`                 -6.841723e-03 1.083921e-03  -6.312013
`name==username`                      2.251309e-01 6.842475e-02   3.290196
`external URL`                       -1.276772e-01 4.378434e-02  -2.916048
new_feature                           2.315379e-02 3.925037e-03   5.899001
new_feature2                          3.242557e-03 2.036056e-03   1.592568
I(`description length`^2)             4.445164e-05 8.326533e-06   5.338553
I(`nums/length username`^2)          -1.136992e+00 2.353216e-01  -4.831652
I(new_feature^2)                     -2.290004e-04 4.857870e-05  -4.714008
`nums/length username`:`#posts`      -3.991730e-03 1.387908e-03  -2.876077
I(`nums/length username`^2):`#posts`  6.911970e-03 3.680055e-03   1.878225
                                         Pr(&gt;|t|)
(Intercept)                          3.745647e-58
`profile pic`                        1.622660e-27
`nums/length username`               2.470245e-19
`description length`                 5.711863e-10
`name==username`                     1.065887e-03
`external URL`                       3.690902e-03
new_feature                          6.424652e-09
new_feature2                         1.118370e-01
I(`description length`^2)            1.377207e-07
I(`nums/length username`^2)          1.762628e-06
I(new_feature^2)                     3.088344e-06
`nums/length username`:`#posts`      4.184069e-03
I(`nums/length username`^2):`#posts` 6.088409e-02</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(modelo2.update)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Regresion_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Regresion_files/figure-html/unnamed-chunk-10-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Regresion_files/figure-html/unnamed-chunk-10-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in sqrt(crit * p * (1 - hh)/hh): Se han producido NaNs

Warning in sqrt(crit * p * (1 - hh)/hh): Se han producido NaNs</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Regresion_files/figure-html/unnamed-chunk-10-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Como podemos observar, al final nos hemos quedado con 10 variables, de las cuales dos de ellas son polinómicas.</p>
<p>Dicho anteriormente, aunque hemos ligeramente mejorado nuestro modelo, no podemos considerarlo como un buen modelo debido a que su R2 sigue siendo aún muy bajo. Además los residuos siguen siguiendo un patrón, no son aleatorios, por lo que en esa parte tampoco hemos mejorado.</p>
</section>
</section>
<section id="section" class="level3" data-number="6.2.5">
<h3 data-number="6.2.5" class="anchored" data-anchor-id="section"><span class="header-section-number">6.2.5</span> </h3>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./FCA.html" class="pagination-link" aria-label="FCA - Formal Concept Analysis">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">FCA - Formal Concept Analysis</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Series.html" class="pagination-link" aria-label="Series temporales">
        <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Series temporales</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>